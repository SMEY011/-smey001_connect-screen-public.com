"use strict";(self.webpackChunkreact_native_testing_library_website=self.webpackChunkreact_native_testing_library_website||[]).push([[298],{2063:(e,n,t)=>{t.d(n,{Z:()=>o});t(7294);var i=t(1351);const s={tableOfContentsInline:"tableOfContentsInline_prmo"};var r=t(5893);function o(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:o}=e;return(0,r.jsx)("div",{className:s.tableOfContentsInline,children:(0,r.jsx)(i.Z,{toc:n,minHeadingLevel:t,maxHeadingLevel:o,className:"table-of-contents",linkClassName:null})})}},1351:(e,n,t)=>{t.d(n,{Z:()=>m});var i=t(7294),s=t(6793);function r(e){const n=e.map((e=>({...e,parentIndex:-1,children:[]}))),t=Array(7).fill(-1);n.forEach(((e,n)=>{const i=t.slice(2,e.level);e.parentIndex=Math.max(...i),t[e.level]=n}));const i=[];return n.forEach((e=>{const{parentIndex:t,...s}=e;t>=0?n[t].children.push(s):i.push(s)})),i}function o(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:i}=e;return n.flatMap((e=>{const n=o({toc:e.children,minHeadingLevel:t,maxHeadingLevel:i});return function(e){return e.level>=t&&e.level<=i}(e)?[{...e,children:n}]:n}))}function c(e){const n=e.getBoundingClientRect();return n.top===n.bottom?c(e.parentNode):n}function l(e,n){var t;let{anchorTopOffset:i}=n;const s=e.find((e=>c(e).top>=i));if(s){var r;return function(e){return e.top>0&&e.bottom<window.innerHeight/2}(c(s))?s:null!=(r=e[e.indexOf(s)-1])?r:null}return null!=(t=e[e.length-1])?t:null}function a(){const e=(0,i.useRef)(0),{navbar:{hideOnScroll:n}}=(0,s.L)();return(0,i.useEffect)((()=>{e.current=n?0:document.querySelector(".navbar").clientHeight}),[n]),e}function d(e){const n=(0,i.useRef)(void 0),t=a();(0,i.useEffect)((()=>{if(!e)return()=>{};const{linkClassName:i,linkActiveClassName:s,minHeadingLevel:r,maxHeadingLevel:o}=e;function c(){const e=function(e){return Array.from(document.getElementsByClassName(e))}(i),c=function(e){let{minHeadingLevel:n,maxHeadingLevel:t}=e;const i=[];for(let s=n;s<=t;s+=1)i.push("h"+s+".anchor");return Array.from(document.querySelectorAll(i.join()))}({minHeadingLevel:r,maxHeadingLevel:o}),a=l(c,{anchorTopOffset:t.current}),d=e.find((e=>a&&a.id===function(e){return decodeURIComponent(e.href.substring(e.href.indexOf("#")+1))}(e)));e.forEach((e=>{!function(e,t){t?(n.current&&n.current!==e&&n.current.classList.remove(s),e.classList.add(s),n.current=e):e.classList.remove(s)}(e,e===d)}))}return document.addEventListener("scroll",c),document.addEventListener("resize",c),c(),()=>{document.removeEventListener("scroll",c),document.removeEventListener("resize",c)}}),[e,t])}var h=t(8746),u=t(5893);function p(e){let{toc:n,className:t,linkClassName:i,isChild:s}=e;return n.length?(0,u.jsx)("ul",{className:s?void 0:t,children:n.map((e=>(0,u.jsxs)("li",{children:[(0,u.jsx)(h.Z,{to:"#"+e.id,className:null!=i?i:void 0,dangerouslySetInnerHTML:{__html:e.value}}),(0,u.jsx)(p,{isChild:!0,toc:e.children,className:t,linkClassName:i})]},e.id)))}):null}const x=i.memo(p);function m(e){let{toc:n,className:t="table-of-contents table-of-contents__left-border",linkClassName:c="table-of-contents__link",linkActiveClassName:l,minHeadingLevel:a,maxHeadingLevel:h,...p}=e;const m=(0,s.L)(),j=null!=a?a:m.tableOfContents.minHeadingLevel,f=null!=h?h:m.tableOfContents.maxHeadingLevel,g=function(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:s}=e;return(0,i.useMemo)((()=>o({toc:r(n),minHeadingLevel:t,maxHeadingLevel:s})),[n,t,s])}({toc:n,minHeadingLevel:j,maxHeadingLevel:f});return d((0,i.useMemo)((()=>{if(c&&l)return{linkClassName:c,linkActiveClassName:l,minHeadingLevel:j,maxHeadingLevel:f}}),[c,l,j,f])),(0,u.jsx)(x,{toc:g,className:t,linkClassName:c,...p})}},1804:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var i=t(5893),s=t(1151),r=t(2063);const o={id:"api",title:"API"},c=void 0,l={id:"api",title:"API",description:"render API",source:"@site/docs/API.md",sourceDirName:".",slug:"/api",permalink:"/react-native-testing-library/docs/api",draft:!1,unlisted:!1,editUrl:"https://github.com/callstack/react-native-testing-library/blob/main/website/docs/API.md",tags:[],version:"current",frontMatter:{id:"api",title:"API"},sidebar:"docs",previous:{title:"FAQ",permalink:"/react-native-testing-library/docs/faq"},next:{title:"Queries",permalink:"/react-native-testing-library/docs/api-queries"}},a={},d=[{value:"<code>render</code> API",id:"render-api",level:2},{value:"Options",id:"render-options",level:3},{value:"<code>wrapper</code> option",id:"wrapper-option",level:4},{value:"<code>createNodeMock</code> option",id:"createnodemock-option",level:4},{value:"<code>unstable_validateStringsRenderedWithinText</code> option",id:"unstable_validatestringsrenderedwithintext-option",level:4},{value:"<code>...queries</code>",id:"queries",level:3},{value:"Example",id:"example",level:4},{value:"<code>update</code>",id:"update",level:3},{value:"<code>unmount</code>",id:"unmount",level:3},{value:"<code>debug</code>",id:"debug",level:3},{value:"<code>message</code> option",id:"message-option",level:4},{value:"<code>mapProps</code> option",id:"mapprops-option",level:4},{value:"<code>debug.shallow</code>",id:"debugshallow",level:4},{value:"<code>toJSON</code>",id:"tojson",level:3},{value:"<code>root</code>",id:"root",level:3},{value:"<code>UNSAFE_root</code>",id:"unsafe_root",level:3},{value:"<code>screen</code> API",id:"screen-api",level:2},{value:"<code>fireEvent</code> API",id:"fireevent-api",level:2},{value:"<code>fireEvent.press</code>",id:"fireeventpress",level:3},{value:"<code>fireEvent.changeText</code>",id:"fireeventchangetext",level:3},{value:"<code>fireEvent.scroll</code>",id:"fireeventscroll",level:3},{value:"On a <code>ScrollView</code>",id:"on-a-scrollview",level:4},{value:"Helper functions",id:"helper-functions",level:2},{value:"<code>waitFor</code>",id:"waitfor",level:3},{value:"Using a React Native version &lt; 0.71 with Jest fake timers",id:"using-a-react-native-version--071-with-jest-fake-timers",level:4},{value:"<code>waitForElementToBeRemoved</code>",id:"waitforelementtoberemoved",level:3},{value:"<code>within</code>, <code>getQueriesForElement</code>",id:"within-getqueriesforelement",level:3},{value:"<code>act</code>",id:"act",level:3},{value:"<code>cleanup</code>",id:"cleanup",level:3},{value:"<code>renderHook</code> API",id:"renderhook-api",level:2},{value:"<code>options</code>",id:"options",level:3},{value:"<code>initialProps</code>",id:"initialprops",level:4},{value:"<code>wrapper</code>",id:"wrapper",level:4},{value:"<code>RenderHookResult</code>",id:"renderhookresult",level:3},{value:"<code>result</code>",id:"result",level:3},{value:"<code>rerender</code>",id:"rerender",level:3},{value:"<code>unmount</code>",id:"unmount-1",level:3},{value:"Examples",id:"examples",level:3},{value:"With <code>initialProps</code>",id:"with-initialprops",level:4},{value:"With <code>wrapper</code>",id:"with-wrapper",level:4},{value:"Configuration",id:"configuration",level:2},{value:"<code>configure</code>",id:"configure",level:3},{value:"<code>asyncUtilTimeout</code> option",id:"asyncutiltimeout-option",level:4},{value:"<code>defaultIncludeHiddenElements</code> option",id:"defaultincludehiddenelements-option",level:4},{value:"<code>defaultDebugOptions</code> option",id:"defaultdebugoptions-option",level:4},{value:"<code>resetToDefaults()</code>",id:"resettodefaults",level:3},{value:"Environment variables",id:"environment-variables",level:3},{value:"<code>RNTL_SKIP_AUTO_CLEANUP</code>",id:"rntl_skip_auto_cleanup",level:4},{value:"<code>RNTL_SKIP_AUTO_DETECT_FAKE_TIMERS</code>",id:"rntl_skip_auto_detect_fake_timers",level:4},{value:"Accessibility",id:"accessibility",level:2},{value:"<code>isHiddenFromAccessibility</code>",id:"ishiddenfromaccessibility",level:3}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(r.Z,{toc:d}),"\n",(0,i.jsxs)(n.h2,{id:"render-api",children:[(0,i.jsx)(n.code,{children:"render"})," API"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/blob/main/src/__tests__/render.test.tsx",children:(0,i.jsx)(n.code,{children:"Example code"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Defined as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"function render(\n  component: React.Element<any>,\n  options?: RenderOptions\n): RenderResult {}\n"})}),"\n",(0,i.jsx)(n.p,{children:"Deeply renders given React element and returns helpers to query the output components structure."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { render } from '@testing-library/react-native';\nimport { QuestionsBoard } from '../QuestionsBoard';\n\ntest('should verify two questions', () => {\n  render(<QuestionsBoard {...props} />);\n  const allQuestions = screen.queryAllByRole('header');\n\n  expect(allQuestions).toHaveLength(2);\n});\n"})}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["When using React context providers, like Redux Provider, you'll likely want to wrap rendered component with them. In such cases it's convenient to create your custom ",(0,i.jsx)(n.code,{children:"render"})," method. ",(0,i.jsx)(n.a,{href:"https://testing-library.com/docs/react-testing-library/setup#custom-render",children:"Follow this great guide on how to set this up"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"render"})," method returns a ",(0,i.jsx)(n.code,{children:"RenderResult"})," object having properties described below."]}),"\n",(0,i.jsxs)(n.admonition,{type:"info",children:[(0,i.jsxs)(n.p,{children:["Latest ",(0,i.jsx)(n.code,{children:"render"})," result is kept in ",(0,i.jsx)(n.a,{href:"#screen",children:(0,i.jsx)(n.code,{children:"screen"})})," variable that can be imported from ",(0,i.jsx)(n.code,{children:"@testing-library/react-native"})," package."]}),(0,i.jsxs)(n.p,{children:["Using ",(0,i.jsx)(n.code,{children:"screen"})," instead of destructuring ",(0,i.jsx)(n.code,{children:"render"})," result is recommended approach. See ",(0,i.jsx)(n.a,{href:"https://kentcdodds.com/blog/common-mistakes-with-react-testing-library#not-using-screen",children:"this article"})," from Kent C. Dodds for more details."]})]}),"\n",(0,i.jsx)(n.h3,{id:"render-options",children:"Options"}),"\n",(0,i.jsxs)(n.p,{children:["The behavior of ",(0,i.jsx)(n.code,{children:"render"})," method can be customized by passing various options as a second argument of ",(0,i.jsx)(n.code,{children:"RenderOptions"})," type:"]}),"\n",(0,i.jsxs)(n.h4,{id:"wrapper-option",children:[(0,i.jsx)(n.code,{children:"wrapper"})," option"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"wrapper?: React.ComponentType<any>,\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This options allows you to wrap tested component, passed as the first option to the ",(0,i.jsx)(n.code,{children:"render()"})," function, in additional wrapper component. This is most useful for creating reusable custom render functions for common React Context providers."]}),"\n",(0,i.jsxs)(n.h4,{id:"createnodemock-option",children:[(0,i.jsx)(n.code,{children:"createNodeMock"})," option"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"createNodeMock?: (element: React.Element<any>) => any,\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This options allows you to pass ",(0,i.jsx)(n.code,{children:"createNodeMock"})," option to ",(0,i.jsx)(n.code,{children:"ReactTestRenderer.create()"})," method in order to allow for custom mock refs. You can learn more about this options from ",(0,i.jsx)(n.a,{href:"https://reactjs.org/docs/test-renderer.html#ideas",children:"React Test Renderer documentation"}),"."]}),"\n",(0,i.jsxs)(n.h4,{id:"unstable_validatestringsrenderedwithintext-option",children:[(0,i.jsx)(n.code,{children:"unstable_validateStringsRenderedWithinText"})," option"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"unstable_validateStringsRenderedWithinText?: boolean;\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["This options is experimental, in some cases it might not work as intended, and its behavior might change without observing ",(0,i.jsx)(n.a,{href:"https://semver.org/",children:"SemVer"})," requirements for breaking changes."]})}),"\n",(0,i.jsxs)(n.p,{children:["This ",(0,i.jsx)(n.strong,{children:"experimental"})," option allows you to replicate React Native behavior of throwing ",(0,i.jsx)(n.code,{children:"Invariant Violation: Text strings must be rendered within a <Text> component"})," error when you try to render ",(0,i.jsx)(n.code,{children:"string"})," value under components different than ",(0,i.jsx)(n.code,{children:"<Text>"}),", e.g. under ",(0,i.jsx)(n.code,{children:"<View>"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"This check is not enforced by React Test Renderer and hence by default React Native Testing Library also does not check this. That might result in runtime errors when running your code on a device, while the code works without errors in tests."}),"\n",(0,i.jsx)(n.h3,{id:"queries",children:(0,i.jsx)(n.code,{children:"...queries"})}),"\n",(0,i.jsxs)(n.p,{children:["The most important feature of ",(0,i.jsx)(n.code,{children:"render"})," is providing a set of helpful queries that allow you to find certain elements in the view hierarchy."]}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/api-queries",children:"Queries"})," for a complete list."]}),"\n",(0,i.jsx)(n.h4,{id:"example",children:"Example"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { render } from '@testing-library/react-native';\n\nconst { getByText, queryByA11yState } = render(<Component />);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"update",children:(0,i.jsx)(n.code,{children:"update"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["Also available under ",(0,i.jsx)(n.code,{children:"rerender"})," alias"]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"update(element: React.Element<any>): void\nrerender(element: React.Element<any>): void\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Re-render the in-memory tree with a new root element. This simulates a React update at the root. If the new element has the same type and key as the previous element, the tree will be updated; otherwise, it will re-mount a new tree. This is useful when testing for ",(0,i.jsx)(n.code,{children:"componentDidUpdate"})," behavior, by passing updated props to the component."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/blob/f96d782d26dd4815dbfd01de6ef7a647efd1f693/src/__tests__/act.test.js#L31-L37",children:"Example code"})}),"\n",(0,i.jsx)(n.h3,{id:"unmount",children:(0,i.jsx)(n.code,{children:"unmount"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"unmount(): void\n"})}),"\n",(0,i.jsx)(n.p,{children:"Unmount the in-memory tree, triggering the appropriate lifecycle events."}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Usually you should not need to call ",(0,i.jsx)(n.code,{children:"unmount"})," as it is done automatically if your test runner supports ",(0,i.jsx)(n.code,{children:"afterEach"})," hook (like Jest, mocha, Jasmine)."]})}),"\n",(0,i.jsx)(n.h3,{id:"debug",children:(0,i.jsx)(n.code,{children:"debug"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"interface DebugOptions {\n  message?: string;\n  mapProps?: MapPropsFunction;\n}\n\ndebug(options?: DebugOptions | string): void\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Pretty prints deeply rendered component passed to ",(0,i.jsx)(n.code,{children:"render"}),"."]}),"\n",(0,i.jsxs)(n.h4,{id:"message-option",children:[(0,i.jsx)(n.code,{children:"message"})," option"]}),"\n",(0,i.jsx)(n.p,{children:"You can provide a message that will be printed on top."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"render(<Component />);\nscreen.debug({ message: 'optional message' });\n"})}),"\n",(0,i.jsx)(n.p,{children:"logs optional message and colored JSX:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"optional message\n\n<View\n  onPress={[Function bound fn]}\n>\n  <Text>Press me</Text>\n</View>\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"mapprops-option",children:[(0,i.jsx)(n.code,{children:"mapProps"})," option"]}),"\n",(0,i.jsxs)(n.p,{children:["You can use the ",(0,i.jsx)(n.code,{children:"mapProps"})," option to transform the props that will be printed :"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"render(<View style={{ backgroundColor: 'red' }} />);\ndebug({ mapProps: ({ style, ...props }) => ({ props }) });\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This will log the rendered JSX without the ",(0,i.jsx)(n.code,{children:"style"})," props."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"children"})," prop cannot be filtered out so the following will print all rendered components with all props but ",(0,i.jsx)(n.code,{children:"children"})," filtered out."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"debug({ mapProps: (props) => ({}) });\n"})}),"\n",(0,i.jsxs)(n.p,{children:["This option can be used to target specific props when debugging a query (for instance keeping only ",(0,i.jsx)(n.code,{children:"children"})," prop when debugging a ",(0,i.jsx)(n.code,{children:"getByText"})," query)."]}),"\n",(0,i.jsx)(n.p,{children:"You can also transform prop values so that they are more readable (e.g. flatten styles)."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { StyleSheet } from 'react-native';\n\ndebug({ mapProps : {({ style, ...props })} => ({ style : StyleSheet.flatten(style), ...props }) });\n"})}),"\n",(0,i.jsx)(n.p,{children:"Or remove props that have little value when debugging tests, e.g. path prop for svgs"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"debug({ mapProps: ({ path, ...props }) => ({ ...props }) });\n"})}),"\n",(0,i.jsx)(n.h4,{id:"debugshallow",children:(0,i.jsx)(n.code,{children:"debug.shallow"})}),"\n",(0,i.jsxs)(n.p,{children:["Pretty prints shallowly rendered component passed to ",(0,i.jsx)(n.code,{children:"render"})," with optional message on top."]}),"\n",(0,i.jsx)(n.h3,{id:"tojson",children:(0,i.jsx)(n.code,{children:"toJSON"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"toJSON(): ReactTestRendererJSON | null\n"})}),"\n",(0,i.jsx)(n.p,{children:"Get the rendered component JSON representation, e.g. for snapshot testing."}),"\n",(0,i.jsx)(n.h3,{id:"root",children:(0,i.jsx)(n.code,{children:"root"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"root: ReactTestInstance;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Returns the rendered root ",(0,i.jsx)(n.a,{href:"testing-env#host-and-composite-components",children:"host element"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["This API is primarily useful in component tests, as it allows you to access root host view without using ",(0,i.jsx)(n.code,{children:"*ByTestId"})," queries or similar methods."]}),"\n",(0,i.jsx)(n.h3,{id:"unsafe_root",children:(0,i.jsx)(n.code,{children:"UNSAFE_root"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"UNSAFE_root: ReactTestInstance;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Returns the rendered ",(0,i.jsx)(n.a,{href:"testing-env#host-and-composite-components",children:"composite root element"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsx)(n.p,{children:"This API typically will return a composite view which goes against recommended testing practices. This API is primarily available for legacy test suites that rely on such testing."})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["This API has been previously named ",(0,i.jsx)(n.code,{children:"container"})," for compatibility with ",(0,i.jsx)(n.a,{href:"https://testing-library.com/docs/react-testing-library/api#container-1",children:"React Testing Library"}),". However, despite the same name, the actual behavior has been signficantly different, hence the name change to ",(0,i.jsx)(n.code,{children:"UNSAFE_root"}),"."]})}),"\n",(0,i.jsxs)(n.h2,{id:"screen-api",children:[(0,i.jsx)(n.code,{children:"screen"})," API"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"let screen: RenderResult;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Hold the value of latest render call for easier access to query and other functions returned by ",(0,i.jsx)(n.a,{href:"#render",children:(0,i.jsx)(n.code,{children:"render"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Its value is automatically cleared after each test by calling ",(0,i.jsx)(n.a,{href:"#cleanup",children:(0,i.jsx)(n.code,{children:"cleanup"})}),". If no ",(0,i.jsx)(n.code,{children:"render"})," call has been made in a given test then it holds a special object that implements ",(0,i.jsx)(n.code,{children:"RenderResult"})," but throws a helpful error on each property and method access."]}),"\n",(0,i.jsx)(n.p,{children:"This can also be used to build test utils that would normally require to be in render scope, either in a test file or globally for your project. For instance:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// Prints the rendered components omitting all props except children.\nconst debugText = () => screen.debug({ mapProps: (props) => ({}) });\n"})}),"\n",(0,i.jsxs)(n.h2,{id:"fireevent-api",children:[(0,i.jsx)(n.code,{children:"fireEvent"})," API"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function fireEvent(\n  element: ReactTestInstance,\n  eventName: string,\n  ...data: Array<any>\n): void {}\n"})}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.p,{children:["For common events like ",(0,i.jsx)(n.code,{children:"press"})," or ",(0,i.jsx)(n.code,{children:"type"})," it's recommended to use ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/user-event",children:"User Event API"})," as it offers\nmore realistic event simulation by emitting a sequence of events with proper event objects that mimic React Native runtime behavior."]}),(0,i.jsx)(n.p,{children:"Use Fire Event for cases not supported by User Event and for triggering event handlers on composite components."})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"fireEvent"})," API allows you to trigger all kind of event handlers on both host and composite components. It will try to invoke a single event handler traversing the component tree bottom-up from passed element and trying to find enabled event handler named ",(0,i.jsx)(n.code,{children:"onXxx"})," when ",(0,i.jsx)(n.code,{children:"xxx"})," is the name of the event passed."]}),"\n",(0,i.jsx)(n.p,{children:"Unlike User Event, this API does not automatically pass event object to event handler, this is responsibility of the user to construct such object."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { render, screen, fireEvent } from '@testing-library/react-native';\n\ntest('fire changeText event', () => {\n  const onEventMock = jest.fn();\n  render(\n    // MyComponent renders TextInput which has a placeholder 'Enter details'\n    // and with `onChangeText` bound to handleChangeText\n    <MyComponent handleChangeText={onEventMock} />\n  );\n\n  fireEvent(screen.getByPlaceholderText('change'), 'onChangeText', 'ab');\n  expect(onEventMock).toHaveBeenCalledWith('ab');\n});\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Please note that from version ",(0,i.jsx)(n.code,{children:"7.0"})," ",(0,i.jsx)(n.code,{children:"fireEvent"})," performs checks that should prevent events firing on disabled elements."]})}),"\n",(0,i.jsxs)(n.p,{children:["An example using ",(0,i.jsx)(n.code,{children:"fireEvent"})," with native events that aren't already aliased by the ",(0,i.jsx)(n.code,{children:"fireEvent"})," api."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { TextInput, View } from 'react-native';\nimport { fireEvent, render } from '@testing-library/react-native';\n\nconst onBlurMock = jest.fn();\n\nrender(\n  <View>\n    <TextInput placeholder=\"my placeholder\" onBlur={onBlurMock} />\n  </View>\n);\n\n// you can omit the `on` prefix\nfireEvent(screen.getByPlaceholderText('my placeholder'), 'blur');\n"})}),"\n",(0,i.jsxs)(n.p,{children:["FireEvent exposes convenience methods for common events like: ",(0,i.jsx)(n.code,{children:"press"}),", ",(0,i.jsx)(n.code,{children:"changeText"}),", ",(0,i.jsx)(n.code,{children:"scroll"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"fireeventpress",children:(0,i.jsx)(n.code,{children:"fireEvent.press"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"fireEvent.press: (element: ReactTestInstance, ...data: Array<any>) => void\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["It is recommended to use the User Event ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/user-event#press",children:(0,i.jsx)(n.code,{children:"press()"})})," helper instead as it offers more realistic simulation of press interaction, including pressable support."]})}),"\n",(0,i.jsxs)(n.p,{children:["Invokes ",(0,i.jsx)(n.code,{children:"press"})," event handler on the element or parent element in the tree."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { View, Text, TouchableOpacity } from 'react-native';\nimport { render, screen, fireEvent } from '@testing-library/react-native';\n\nconst onPressMock = jest.fn();\nconst eventData = {\n  nativeEvent: {\n    pageX: 20,\n    pageY: 30,\n  },\n};\n\nrender(\n  <View>\n    <TouchableOpacity onPress={onPressMock}>\n      <Text>Press me</Text>\n    </TouchableOpacity>\n  </View>\n);\n\nfireEvent.press(screen.getByText('Press me'), eventData);\nexpect(onPressMock).toHaveBeenCalledWith(eventData);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"fireeventchangetext",children:(0,i.jsx)(n.code,{children:"fireEvent.changeText"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"fireEvent.changeText: (element: ReactTestInstance, ...data: Array<any>) => void\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["It is recommended to use the User Event ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/user-event#type",children:(0,i.jsx)(n.code,{children:"type()"})})," helper instead as it offers more realistic simulation of text change interaction, including key-by-key typing, element focus, and other editing events."]})}),"\n",(0,i.jsxs)(n.p,{children:["Invokes ",(0,i.jsx)(n.code,{children:"changeText"})," event handler on the element or parent element in the tree."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { View, TextInput } from 'react-native';\nimport { render, screen, fireEvent } from '@testing-library/react-native';\n\nconst onChangeTextMock = jest.fn();\nconst CHANGE_TEXT = 'content';\n\nrender(\n  <View>\n    <TextInput placeholder=\"Enter data\" onChangeText={onChangeTextMock} />\n  </View>\n);\n\nfireEvent.changeText(screen.getByPlaceholderText('Enter data'), CHANGE_TEXT);\n"})}),"\n",(0,i.jsx)(n.h3,{id:"fireeventscroll",children:(0,i.jsx)(n.code,{children:"fireEvent.scroll"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"fireEvent.scroll: (element: ReactTestInstance, ...data: Array<any>) => void\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Invokes ",(0,i.jsx)(n.code,{children:"scroll"})," event handler on the element or parent element in the tree."]}),"\n",(0,i.jsxs)(n.h4,{id:"on-a-scrollview",children:["On a ",(0,i.jsx)(n.code,{children:"ScrollView"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { ScrollView, Text } from 'react-native';\nimport { render, screen, fireEvent } from '@testing-library/react-native';\n\nconst onScrollMock = jest.fn();\nconst eventData = {\n  nativeEvent: {\n    contentOffset: {\n      y: 200,\n    },\n  },\n};\n\nrender(\n  <ScrollView onScroll={onScrollMock}>\n    <Text>XD</Text>\n  </ScrollView>\n);\n\nfireEvent.scroll(screen.getByText('scroll-view'), eventData);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"helper-functions",children:"Helper functions"}),"\n",(0,i.jsx)(n.h3,{id:"waitfor",children:(0,i.jsx)(n.code,{children:"waitFor"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/blob/main/src/__tests__/waitFor.test.tsx",children:(0,i.jsx)(n.code,{children:"Example code"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Defined as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"function waitFor<T>(\n  expectation: () => T,\n  { timeout: number = 1000, interval: number = 50 }\n): Promise<T> {}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Waits for a period of time for the ",(0,i.jsx)(n.code,{children:"expectation"})," callback to pass. ",(0,i.jsx)(n.code,{children:"waitFor"})," may run the callback a number of times until timeout is reached, as specified by the ",(0,i.jsx)(n.code,{children:"timeout"})," and ",(0,i.jsx)(n.code,{children:"interval"})," options. The callback must throw an error when the expectation is not met. Returning any value, including a falsy one, will be treated as meeting the expectation, and the callback result will be returned to the caller of ",(0,i.jsx)(n.code,{children:"waitFor"})," function."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"await waitFor(() => expect(mockFunction).toHaveBeenCalledWith()))\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"waitFor"})," function will be executing ",(0,i.jsx)(n.code,{children:"expectation"})," callback every ",(0,i.jsx)(n.code,{children:"interval"})," (default: every 50 ms) until ",(0,i.jsx)(n.code,{children:"timeout"})," (default: 1000 ms) is reached. The repeated execution of callback is stopped as soon as it does not throw an error, in such case the value returned by the callback is returned to ",(0,i.jsx)(n.code,{children:"waitFor"})," caller. Otherwise, when it reaches the timeout, the final error thrown by ",(0,i.jsx)(n.code,{children:"expectation"})," will be re-thrown by ",(0,i.jsx)(n.code,{children:"waitFor"})," to the calling code."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// \u274c `waitFor` will return immediately because callback does not throw\nawait waitFor(() => false);\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"waitFor"})," is an async function so you need to ",(0,i.jsx)(n.code,{children:"await"})," the result to pause test execution."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"// \u274c missing `await`: `waitFor` will just return Promise that will be rejected when the timeout is reached\nwaitFor(() => expect(1).toBe(2));\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["You can enforce awaiting ",(0,i.jsx)(n.code,{children:"waitFor"})," by using the ",(0,i.jsx)(n.a,{href:"https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/await-async-utils.md",children:"await-async-utils"})," rule from ",(0,i.jsx)(n.a,{href:"https://github.com/testing-library/eslint-plugin-testing-library",children:"eslint-plugin-testing-library"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:["Since ",(0,i.jsx)(n.code,{children:"waitFor"})," is likely to run ",(0,i.jsx)(n.code,{children:"expectation"})," callback multiple times, it is highly recommended for it ",(0,i.jsx)(n.a,{href:"https://kentcdodds.com/blog/common-mistakes-with-react-testing-library#performing-side-effects-in-waitfor",children:"not to perform any side effects"})," in ",(0,i.jsx)(n.code,{children:"waitFor"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"await waitFor(() => {\n  // \u274c button will be pressed on each waitFor iteration\n  fireEvent.press(screen.getByText('press me'));\n  expect(mockOnPress).toHaveBeenCalled();\n});\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Avoiding side effects in ",(0,i.jsx)(n.code,{children:"expectation"})," callback can be partially enforced with the ",(0,i.jsxs)(n.a,{href:"https://github.com/testing-library/eslint-plugin-testing-library/blob/main/docs/rules/no-wait-for-side-effects.md",children:[(0,i.jsx)(n.code,{children:"no-wait-for-side-effects"})," rule"]}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:["It is also recommended to have a ",(0,i.jsxs)(n.a,{href:"https://kentcdodds.com/blog/common-mistakes-with-react-testing-library#having-multiple-assertions-in-a-single-waitfor-callback",children:["single assertion per each ",(0,i.jsx)(n.code,{children:"waitFor"})]})," for more consistency and faster failing tests. If you want to make several assertions, then they should be in seperate ",(0,i.jsx)(n.code,{children:"waitFor"})," calls. In many cases you won't actually need to wrap the second assertion in ",(0,i.jsx)(n.code,{children:"waitFor"})," since the first one will do the waiting required for asynchronous change to happen."]}),"\n",(0,i.jsx)(n.h4,{id:"using-a-react-native-version--071-with-jest-fake-timers",children:"Using a React Native version < 0.71 with Jest fake timers"}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.p,{children:["When using a version of React Native < 0.71 and modern fake timers (the default for ",(0,i.jsx)(n.code,{children:"Jest"})," >= 27), ",(0,i.jsx)(n.code,{children:"waitFor"})," won't work (it will always timeout even if ",(0,i.jsx)(n.code,{children:"expectation()"})," doesn't throw) unless you use the custom ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library#custom-jest-preset",children:"@testing-library/react-native preset"}),"."]})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"waitFor"})," checks whether Jest fake timers are enabled and adapts its behavior in such case. The following snippet is a simplified version of how it behaves when fake timers are enabled:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"let fakeTimeRemaining = timeout;\nlet lastError;\n\nwhile (fakeTimeRemaining > 0) {\n  fakeTimeRemaining = fakeTimeRemaining - interval;\n  jest.advanceTimersByTime(interval);\n  try {\n    // resolve\n    return expectation();\n  } catch (error) {\n    lastError = error;\n  }\n}\n\n// reject\nthrow lastError;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["In the following example we test that a function is called after 10 seconds using fake timers. Since we're using fake timers, the test won't depend on real time passing and thus be much faster and more reliable. Also we don't have to advance fake timers through Jest fake timers API because ",(0,i.jsx)(n.code,{children:"waitFor"})," already does this for us."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"// in component\nsetTimeout(() => {\n  someFunction();\n}, 10000);\n\n// in test\njest.useFakeTimers();\n\nawait waitFor(() => {\n  expect(someFunction).toHaveBeenCalledWith();\n}, 10000);\n"})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["In order to properly use ",(0,i.jsx)(n.code,{children:"waitFor"})," you need at least React >=16.9.0 (featuring async ",(0,i.jsx)(n.code,{children:"act"}),") or React Native >=0.61 (which comes with React >=16.9.0)."]})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["If you receive warnings related to ",(0,i.jsx)(n.code,{children:"act()"})," function consult our ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/understanding-act",children:"Undestanding Act"})," function document."]})}),"\n",(0,i.jsx)(n.h3,{id:"waitforelementtoberemoved",children:(0,i.jsx)(n.code,{children:"waitForElementToBeRemoved"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/blob/main/src/__tests__/waitForElementToBeRemoved.test.tsx",children:(0,i.jsx)(n.code,{children:"Example code"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Defined as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function waitForElementToBeRemoved<T>(\n  expectation: () => T,\n  { timeout: number = 4500, interval: number = 50 }\n): Promise<T> {}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Waits for non-deterministic periods of time until queried element is removed or times out. ",(0,i.jsx)(n.code,{children:"waitForElementToBeRemoved"})," periodically calls ",(0,i.jsx)(n.code,{children:"expectation"})," every ",(0,i.jsx)(n.code,{children:"interval"})," milliseconds to determine whether the element has been removed or not."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { render, screen, waitForElementToBeRemoved } from '@testing-library/react-native';\n\ntest('waiting for an Banana to be removed', async () => {\n  render(<Banana />);\n\n  await waitForElementToBeRemoved(() => screen.getByText('Banana ready'));\n});\n"})}),"\n",(0,i.jsx)(n.p,{children:"This method expects that the element is initially present in the render tree and then is removed from it. If the element is not present when you call this method it throws an error."}),"\n",(0,i.jsxs)(n.p,{children:["You can use any of ",(0,i.jsx)(n.code,{children:"getBy"}),", ",(0,i.jsx)(n.code,{children:"getAllBy"}),", ",(0,i.jsx)(n.code,{children:"queryBy"})," and ",(0,i.jsx)(n.code,{children:"queryAllBy"})," queries for ",(0,i.jsx)(n.code,{children:"expectation"})," parameter."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["In order to properly use ",(0,i.jsx)(n.code,{children:"waitForElementToBeRemoved"})," you need at least React >=16.9.0 (featuring async ",(0,i.jsx)(n.code,{children:"act"}),") or React Native >=0.61 (which comes with React >=16.9.0)."]})}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["If you receive warnings related to ",(0,i.jsx)(n.code,{children:"act()"})," function consult our ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/understanding-act",children:"Undestanding Act"})," function document."]})}),"\n",(0,i.jsxs)(n.h3,{id:"within-getqueriesforelement",children:[(0,i.jsx)(n.code,{children:"within"}),", ",(0,i.jsx)(n.code,{children:"getQueriesForElement"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/blob/main/src/__tests__/within.test.tsx",children:(0,i.jsx)(n.code,{children:"Example code"})})}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Defined as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"function within(element: ReactTestInstance): Queries {}\n\nfunction getQueriesForElement(element: ReactTestInstance): Queries {}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"within"})," (also available as ",(0,i.jsx)(n.code,{children:"getQueriesForElement"})," alias) performs ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/api-queries",children:"queries"})," scoped to given element."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Please note that additional ",(0,i.jsx)(n.code,{children:"render"})," specific operations like ",(0,i.jsx)(n.code,{children:"update"}),", ",(0,i.jsx)(n.code,{children:"unmount"}),", ",(0,i.jsx)(n.code,{children:"debug"}),", ",(0,i.jsx)(n.code,{children:"toJSON"})," are ",(0,i.jsx)(n.em,{children:"not"})," included."]})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"const detailsScreen = within(screen.getByA11yHint('Details Screen'));\nexpect(detailsScreen.getByText('Some Text')).toBeOnTheScreen();\nexpect(detailsScreen.getByDisplayValue('Some Value')).toBeOnTheScreen();\nexpect(detailsScreen.queryByLabelText('Some Label')).toBeOnTheScreen();\nawait expect(detailsScreen.findByA11yHint('Some Label')).resolves.toBeOnTheScreen();\n"})}),"\n",(0,i.jsx)(n.p,{children:"Use cases for scoped queries include:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"queries scoped to a single item inside a FlatList containing many items"}),"\n",(0,i.jsx)(n.li,{children:"queries scoped to a single screen in tests involving screen transitions (e.g. with react-navigation)"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"act",children:(0,i.jsx)(n.code,{children:"act"})}),"\n",(0,i.jsxs)(n.p,{children:["Useful function to help testing components that use hooks API. By default any ",(0,i.jsx)(n.code,{children:"render"}),", ",(0,i.jsx)(n.code,{children:"update"}),", ",(0,i.jsx)(n.code,{children:"fireEvent"}),", and ",(0,i.jsx)(n.code,{children:"waitFor"})," calls are wrapped by this function, so there is no need to wrap it manually. This method is re-exported from ",(0,i.jsx)(n.a,{href:"https://github.com/facebook/react/blob/main/packages/react-test-renderer/src/ReactTestRenderer.js#L567%5D",children:(0,i.jsx)(n.code,{children:"react-test-renderer"})}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Consult our ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/understanding-act",children:"Undestanding Act function"})," document for more understanding of its intricacies."]}),"\n",(0,i.jsx)(n.h3,{id:"cleanup",children:(0,i.jsx)(n.code,{children:"cleanup"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const cleanup: () => void;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Unmounts React trees that were mounted with ",(0,i.jsx)(n.code,{children:"render"})," and clears ",(0,i.jsx)(n.code,{children:"screen"})," variable that holds latest ",(0,i.jsx)(n.code,{children:"render"})," output."]}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsxs)(n.p,{children:["Please note that this is done automatically if the testing framework you're using supports the ",(0,i.jsx)(n.code,{children:"afterEach"})," global (like mocha, Jest, and Jasmine). If not, you will need to do manual cleanups after each test."]})}),"\n",(0,i.jsxs)(n.p,{children:["For example, if you're using the ",(0,i.jsx)(n.code,{children:"jest"})," testing framework, then you would need to use the ",(0,i.jsx)(n.code,{children:"afterEach"})," hook like so:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"import { cleanup, render } from '@testing-library/react-native/pure';\nimport { View } from 'react-native';\n\nafterEach(cleanup);\n\nit('renders a view', () => {\n  render(<View />);\n  // ...\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"afterEach(cleanup)"})," call also works in ",(0,i.jsx)(n.code,{children:"describe"})," blocks:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-jsx",children:"describe('when logged in', () => {\n  afterEach(cleanup);\n\n  it('renders the user', () => {\n    render(<SiteHeader />);\n    // ...\n  });\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Failing to call ",(0,i.jsx)(n.code,{children:"cleanup"})," when you've called ",(0,i.jsx)(n.code,{children:"render"}),' could result in a memory leak and tests which are not "idempotent" (which can lead to difficult to debug errors in your tests).']}),"\n",(0,i.jsxs)(n.h2,{id:"renderhook-api",children:[(0,i.jsx)(n.code,{children:"renderHook"})," API"]}),"\n",(0,i.jsx)(n.p,{children:"Defined as:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function renderHook<Result, Props>(\n  callback: (props?: Props) => Result,\n  options?: RenderHookOptions<Props>\n): RenderHookResult<Result, Props>;\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Renders a test component that will call the provided ",(0,i.jsx)(n.code,{children:"callback"}),", including any hooks it calls, every time it renders. Returns ",(0,i.jsx)(n.a,{href:"#renderhookresult-object",children:(0,i.jsx)(n.code,{children:"RenderHookResult"})})," object, which you can interact with."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"import { renderHook } from '@testing-library/react-native';\nimport { useCount } from '../useCount';\n\nit('should increment count', () => {\n  const { result } = renderHook(() => useCount());\n\n  expect(result.current.count).toBe(0);\n  act(() => {\n    // Note that you should wrap the calls to functions your hook returns with `act` if they trigger an update of your hook's state to ensure pending useEffects are run before your next assertion.\n    result.current.increment();\n  });\n  expect(result.current.count).toBe(1);\n});\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"// useCount.js\nexport const useCount = () => {\n  const [count, setCount] = useState(0);\n  const increment = () => setCount((previousCount) => previousCount + 1);\n\n  return { count, increment };\n};\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"renderHook"})," function accepts the following arguments:"]}),"\n",(0,i.jsxs)(n.p,{children:["Callback is a function that is called each ",(0,i.jsx)(n.code,{children:"render"})," of the test component. This function should call one or more hooks for testing."]}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"props"})," passed into the callback will be the ",(0,i.jsx)(n.code,{children:"initialProps"})," provided in the ",(0,i.jsx)(n.code,{children:"options"})," to ",(0,i.jsx)(n.code,{children:"renderHook"}),", unless new props are provided by a subsequent ",(0,i.jsx)(n.code,{children:"rerender"})," call."]}),"\n",(0,i.jsx)(n.h3,{id:"options",children:(0,i.jsx)(n.code,{children:"options"})}),"\n",(0,i.jsxs)(n.p,{children:["A ",(0,i.jsx)(n.code,{children:"RenderHookOptions<Props>"})," object to modify the execution of the ",(0,i.jsx)(n.code,{children:"callback"})," function, containing the following properties:"]}),"\n",(0,i.jsx)(n.h4,{id:"initialprops",children:(0,i.jsx)(n.code,{children:"initialProps"})}),"\n",(0,i.jsxs)(n.p,{children:["The initial values to pass as ",(0,i.jsx)(n.code,{children:"props"})," to the ",(0,i.jsx)(n.code,{children:"callback"})," function of ",(0,i.jsx)(n.code,{children:"renderHook"}),". The ",(0,i.jsx)(n.code,{children:"Props"})," type is determined by the type passed to or inferred by the ",(0,i.jsx)(n.code,{children:"renderHook"})," call."]}),"\n",(0,i.jsx)(n.h4,{id:"wrapper",children:(0,i.jsx)(n.code,{children:"wrapper"})}),"\n",(0,i.jsxs)(n.p,{children:["A React component to wrap the test component in when rendering. This is usually used to add context providers from ",(0,i.jsx)(n.code,{children:"React.createContext"})," for the hook to access with ",(0,i.jsx)(n.code,{children:"useContext"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"renderhookresult",children:(0,i.jsx)(n.code,{children:"RenderHookResult"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"interface RenderHookResult<Result, Props> {\n  result: { current: Result };\n  rerender: (props: Props) => void;\n  unmount: () => void;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"renderHook"})," function returns an object that has the following properties:"]}),"\n",(0,i.jsx)(n.h3,{id:"result",children:(0,i.jsx)(n.code,{children:"result"})}),"\n",(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"current"})," value of the ",(0,i.jsx)(n.code,{children:"result"})," will reflect the latest of whatever is returned from the ",(0,i.jsx)(n.code,{children:"callback"})," passed to ",(0,i.jsx)(n.code,{children:"renderHook"}),". The ",(0,i.jsx)(n.code,{children:"Result"})," type is determined by the type passed to or inferred by the ",(0,i.jsx)(n.code,{children:"renderHook"})," call."]}),"\n",(0,i.jsx)(n.h3,{id:"rerender",children:(0,i.jsx)(n.code,{children:"rerender"})}),"\n",(0,i.jsxs)(n.p,{children:["A function to rerender the test component, causing any hooks to be recalculated. If ",(0,i.jsx)(n.code,{children:"newProps"})," are passed, they will replace the ",(0,i.jsx)(n.code,{children:"callback"})," function's ",(0,i.jsx)(n.code,{children:"initialProps"})," for subsequent rerenders. The ",(0,i.jsx)(n.code,{children:"Props"})," type is determined by the type passed to or inferred by the ",(0,i.jsx)(n.code,{children:"renderHook"})," call."]}),"\n",(0,i.jsx)(n.h3,{id:"unmount-1",children:(0,i.jsx)(n.code,{children:"unmount"})}),"\n",(0,i.jsxs)(n.p,{children:["A function to unmount the test component. This is commonly used to trigger cleanup effects for ",(0,i.jsx)(n.code,{children:"useEffect"})," hooks."]}),"\n",(0,i.jsx)(n.h3,{id:"examples",children:"Examples"}),"\n",(0,i.jsxs)(n.p,{children:["Here we present some extra examples of using ",(0,i.jsx)(n.code,{children:"renderHook"})," API."]}),"\n",(0,i.jsxs)(n.h4,{id:"with-initialprops",children:["With ",(0,i.jsx)(n.code,{children:"initialProps"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"const useCount = (initialCount: number) => {\n  const [count, setCount] = useState(initialCount);\n  const increment = () => setCount((previousCount) => previousCount + 1);\n\n  useEffect(() => {\n    setCount(initialCount);\n  }, [initialCount]);\n\n  return { count, increment };\n};\n\nit('should increment count', () => {\n  const { result, rerender } = renderHook((initialCount: number) => useCount(initialCount), {\n    initialProps: 1,\n  });\n\n  expect(result.current.count).toBe(1);\n\n  act(() => {\n    result.current.increment();\n  });\n\n  expect(result.current.count).toBe(2);\n  rerender(5);\n  expect(result.current.count).toBe(5);\n});\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"with-wrapper",children:["With ",(0,i.jsx)(n.code,{children:"wrapper"})]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-tsx",children:"it('should use context value', () => {\n  function Wrapper({ children }: { children: ReactNode }) {\n    return <Context.Provider value=\"provided\">{children}</Context.Provider>;\n  }\n\n  const { result } = renderHook(() => useHook(), { wrapper: Wrapper });\n  // ...\n});\n"})}),"\n",(0,i.jsx)(n.h2,{id:"configuration",children:"Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"configure",children:(0,i.jsx)(n.code,{children:"configure"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"type Config = {\n  asyncUtilTimeout: number;\n  defaultHidden: boolean;\n  defaultDebugOptions: Partial<DebugOptions>;\n};\n\nfunction configure(options: Partial<Config>) {}\n"})}),"\n",(0,i.jsxs)(n.h4,{id:"asyncutiltimeout-option",children:[(0,i.jsx)(n.code,{children:"asyncUtilTimeout"})," option"]}),"\n",(0,i.jsxs)(n.p,{children:["Default timeout, in ms, for async helper functions (",(0,i.jsx)(n.code,{children:"waitFor"}),", ",(0,i.jsx)(n.code,{children:"waitForElementToBeRemoved"}),") and ",(0,i.jsx)(n.code,{children:"findBy*"})," queries. Defaults to 1000 ms."]}),"\n",(0,i.jsxs)(n.h4,{id:"defaultincludehiddenelements-option",children:[(0,i.jsx)(n.code,{children:"defaultIncludeHiddenElements"})," option"]}),"\n",(0,i.jsxs)(n.p,{children:["Default value for ",(0,i.jsx)(n.a,{href:"/react-native-testing-library/docs/api-queries#includehiddenelements-option",children:"includeHiddenElements"})," query option for all queries. The default value is set to ",(0,i.jsx)(n.code,{children:"false"}),", so all queries will not match ",(0,i.jsx)(n.a,{href:"#ishiddenfromaccessibility",children:"elements hidden from accessibility"}),". This is because the users of the app would not be able to see such elements."]}),"\n",(0,i.jsxs)(n.p,{children:["This option is also available as ",(0,i.jsx)(n.code,{children:"defaultHidden"})," alias for compatibility with ",(0,i.jsx)(n.a,{href:"https://testing-library.com/docs/dom-testing-library/api-configuration/#defaulthidden",children:"React Testing Library"}),"."]}),"\n",(0,i.jsxs)(n.h4,{id:"defaultdebugoptions-option",children:[(0,i.jsx)(n.code,{children:"defaultDebugOptions"})," option"]}),"\n",(0,i.jsxs)(n.p,{children:["Default ",(0,i.jsx)(n.a,{href:"#debug",children:"debug options"})," to be used when calling ",(0,i.jsx)(n.code,{children:"debug()"}),". These default options will be overridden by the ones you specify directly when calling ",(0,i.jsx)(n.code,{children:"debug()"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"resettodefaults",children:(0,i.jsx)(n.code,{children:"resetToDefaults()"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function resetToDefaults() {}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"environment-variables",children:"Environment variables"}),"\n",(0,i.jsx)(n.h4,{id:"rntl_skip_auto_cleanup",children:(0,i.jsx)(n.code,{children:"RNTL_SKIP_AUTO_CLEANUP"})}),"\n",(0,i.jsxs)(n.p,{children:["Set to ",(0,i.jsx)(n.code,{children:"true"})," to disable automatic ",(0,i.jsx)(n.code,{children:"cleanup()"})," after each test. It works the same as importing ",(0,i.jsx)(n.code,{children:"react-native-testing-library/dont-cleanup-after-each"})," or using ",(0,i.jsx)(n.code,{children:"react-native-testing-library/pure"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ RNTL_SKIP_AUTO_CLEANUP=true jest\n"})}),"\n",(0,i.jsx)(n.h4,{id:"rntl_skip_auto_detect_fake_timers",children:(0,i.jsx)(n.code,{children:"RNTL_SKIP_AUTO_DETECT_FAKE_TIMERS"})}),"\n",(0,i.jsxs)(n.p,{children:["Set to ",(0,i.jsx)(n.code,{children:"true"})," to disable auto-detection of fake timers. This might be useful in rare cases when you want to use non-Jest fake timers. See ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/issues/886",children:"issue #886"})," for more details."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-shell",children:"$ RNTL_SKIP_AUTO_DETECT_FAKE_TIMERS=true jest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"accessibility",children:"Accessibility"}),"\n",(0,i.jsx)(n.h3,{id:"ishiddenfromaccessibility",children:(0,i.jsx)(n.code,{children:"isHiddenFromAccessibility"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"function isHiddenFromAccessibility(\n  element: ReactTestInstance | null\n): boolean {}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Also available as ",(0,i.jsx)(n.code,{children:"isInaccessible()"})," alias for React Testing Library compatibility."]}),"\n",(0,i.jsx)(n.p,{children:"Checks if given element is hidden from assistive technology, e.g. screen readers."}),"\n",(0,i.jsxs)(n.admonition,{type:"note",children:[(0,i.jsxs)(n.p,{children:["Like ",(0,i.jsx)(n.a,{href:"https://testing-library.com/docs/dom-testing-library/api-accessibility/#isinaccessible",children:(0,i.jsx)(n.code,{children:"isInaccessible"})})," function from DOM Testing Library this function considers both accessibility elements and presentational elements (regular ",(0,i.jsx)(n.code,{children:"View"}),"s) to be accessible, unless they are hidden in terms of host platform."]}),(0,i.jsxs)(n.p,{children:["This covers only part of ",(0,i.jsx)(n.a,{href:"https://www.w3.org/TR/wai-aria-1.2/#tree_exclusion",children:"ARIA notion of Accessiblity Tree"}),", as ARIA excludes both hidden and presentational elements from the Accessibility Tree."]})]}),"\n",(0,i.jsx)(n.p,{children:"For the scope of this function, element is inaccessible when it, or any of its ancestors, meets any of the following conditions:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["it has ",(0,i.jsx)(n.code,{children:"display: none"})," style"]}),"\n",(0,i.jsxs)(n.li,{children:["it has ",(0,i.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#aria-hidden",children:(0,i.jsx)(n.code,{children:"aria-hidden"})})," prop set to ",(0,i.jsx)(n.code,{children:"true"})]}),"\n",(0,i.jsxs)(n.li,{children:["it has ",(0,i.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#accessibilityelementshidden-ios",children:(0,i.jsx)(n.code,{children:"accessibilityElementsHidden"})})," prop set to ",(0,i.jsx)(n.code,{children:"true"})]}),"\n",(0,i.jsxs)(n.li,{children:["it has ",(0,i.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#importantforaccessibility-android",children:(0,i.jsx)(n.code,{children:"importantForAccessibility"})})," prop set to ",(0,i.jsx)(n.code,{children:"no-hide-descendants"})]}),"\n",(0,i.jsxs)(n.li,{children:["it has sibling host element with either ",(0,i.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#aria-modal-ios",children:(0,i.jsx)(n.code,{children:"aria-modal"})})," or ",(0,i.jsx)(n.a,{href:"https://reactnative.dev/docs/accessibility#accessibilityviewismodal-ios",children:(0,i.jsx)(n.code,{children:"accessibilityViewIsModal"})})," prop set to ",(0,i.jsx)(n.code,{children:"true"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Specifying ",(0,i.jsx)(n.code,{children:"accessible={false}"}),", ",(0,i.jsx)(n.code,{children:'accessiblityRole="none"'}),", or ",(0,i.jsx)(n.code,{children:'importantForAccessibility="no"'})," props does not cause the element to become inaccessible."]})]})}function u(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>o});var i=t(7294);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);