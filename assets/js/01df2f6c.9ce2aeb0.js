"use strict";(self.webpackChunkreact_native_testing_library_website=self.webpackChunkreact_native_testing_library_website||[]).push([[278],{2063:(e,n,t)=>{t.d(n,{Z:()=>s});t(7294);var i=t(1351);const r={tableOfContentsInline:"tableOfContentsInline_prmo"};var a=t(5893);function s(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:s}=e;return(0,a.jsx)("div",{className:r.tableOfContentsInline,children:(0,a.jsx)(i.Z,{toc:n,minHeadingLevel:t,maxHeadingLevel:s,className:"table-of-contents",linkClassName:null})})}},1351:(e,n,t)=>{t.d(n,{Z:()=>g});var i=t(7294),r=t(6793);function a(e){const n=e.map((e=>({...e,parentIndex:-1,children:[]}))),t=Array(7).fill(-1);n.forEach(((e,n)=>{const i=t.slice(2,e.level);e.parentIndex=Math.max(...i),t[e.level]=n}));const i=[];return n.forEach((e=>{const{parentIndex:t,...r}=e;t>=0?n[t].children.push(r):i.push(r)})),i}function s(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:i}=e;return n.flatMap((e=>{const n=s({toc:e.children,minHeadingLevel:t,maxHeadingLevel:i});return function(e){return e.level>=t&&e.level<=i}(e)?[{...e,children:n}]:n}))}function o(e){const n=e.getBoundingClientRect();return n.top===n.bottom?o(e.parentNode):n}function c(e,n){var t;let{anchorTopOffset:i}=n;const r=e.find((e=>o(e).top>=i));if(r){var a;return function(e){return e.top>0&&e.bottom<window.innerHeight/2}(o(r))?r:null!=(a=e[e.indexOf(r)-1])?a:null}return null!=(t=e[e.length-1])?t:null}function l(){const e=(0,i.useRef)(0),{navbar:{hideOnScroll:n}}=(0,r.L)();return(0,i.useEffect)((()=>{e.current=n?0:document.querySelector(".navbar").clientHeight}),[n]),e}function d(e){const n=(0,i.useRef)(void 0),t=l();(0,i.useEffect)((()=>{if(!e)return()=>{};const{linkClassName:i,linkActiveClassName:r,minHeadingLevel:a,maxHeadingLevel:s}=e;function o(){const e=function(e){return Array.from(document.getElementsByClassName(e))}(i),o=function(e){let{minHeadingLevel:n,maxHeadingLevel:t}=e;const i=[];for(let r=n;r<=t;r+=1)i.push("h"+r+".anchor");return Array.from(document.querySelectorAll(i.join()))}({minHeadingLevel:a,maxHeadingLevel:s}),l=c(o,{anchorTopOffset:t.current}),d=e.find((e=>l&&l.id===function(e){return decodeURIComponent(e.href.substring(e.href.indexOf("#")+1))}(e)));e.forEach((e=>{!function(e,t){t?(n.current&&n.current!==e&&n.current.classList.remove(r),e.classList.add(r),n.current=e):e.classList.remove(r)}(e,e===d)}))}return document.addEventListener("scroll",o),document.addEventListener("resize",o),o(),()=>{document.removeEventListener("scroll",o),document.removeEventListener("resize",o)}}),[e,t])}var u=t(8746),h=t(5893);function m(e){let{toc:n,className:t,linkClassName:i,isChild:r}=e;return n.length?(0,h.jsx)("ul",{className:r?void 0:t,children:n.map((e=>(0,h.jsxs)("li",{children:[(0,h.jsx)(u.Z,{to:"#"+e.id,className:null!=i?i:void 0,dangerouslySetInnerHTML:{__html:e.value}}),(0,h.jsx)(m,{isChild:!0,toc:e.children,className:t,linkClassName:i})]},e.id)))}):null}const p=i.memo(m);function g(e){let{toc:n,className:t="table-of-contents table-of-contents__left-border",linkClassName:o="table-of-contents__link",linkActiveClassName:c,minHeadingLevel:l,maxHeadingLevel:u,...m}=e;const g=(0,r.L)(),v=null!=l?l:g.tableOfContents.minHeadingLevel,f=null!=u?u:g.tableOfContents.maxHeadingLevel,x=function(e){let{toc:n,minHeadingLevel:t,maxHeadingLevel:r}=e;return(0,i.useMemo)((()=>s({toc:a(n),minHeadingLevel:t,maxHeadingLevel:r})),[n,t,r])}({toc:n,minHeadingLevel:v,maxHeadingLevel:f});return d((0,i.useMemo)((()=>{if(o&&c)return{linkClassName:o,linkActiveClassName:c,minHeadingLevel:v,maxHeadingLevel:f}}),[o,c,v,f])),(0,h.jsx)(p,{toc:x,className:t,linkClassName:o,...m})}},5448:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>d});var i=t(5893),r=t(1151),a=t(2063);const s={id:"troubleshooting",title:"Troubleshooting"},o=void 0,c={id:"troubleshooting",title:"Troubleshooting",description:"This guide describes common issues found by users when integrating React Native Test Library to their projects:",source:"@site/docs/Troubleshooting.md",sourceDirName:".",slug:"/troubleshooting",permalink:"/react-native-testing-library/docs/troubleshooting",draft:!1,unlisted:!1,editUrl:"https://github.com/callstack/react-native-testing-library/blob/main/website/docs/Troubleshooting.md",tags:[],version:"current",frontMatter:{id:"troubleshooting",title:"Troubleshooting"},sidebar:"docs",previous:{title:"How Should I Query?",permalink:"/react-native-testing-library/docs/how-should-i-query"},next:{title:"FAQ",permalink:"/react-native-testing-library/docs/faq"}},l={},d=[{value:"Matching React Native, React &amp; React Test Renderer versions",id:"matching-react-native-react--react-test-renderer-versions",level:2},{value:"Example repository",id:"example-repository",level:2},{value:"Undefined component error",id:"undefined-component-error",level:2},{value:"Mocking React Native",id:"mocking-react-native",level:3},{value:"Act warnings",id:"act-warnings",level:2}];function u(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"This guide describes common issues found by users when integrating React Native Test Library to their projects:"}),"\n",(0,i.jsx)(a.Z,{toc:d}),"\n",(0,i.jsx)(n.h2,{id:"matching-react-native-react--react-test-renderer-versions",children:"Matching React Native, React & React Test Renderer versions"}),"\n",(0,i.jsx)(n.p,{children:"Check that you have matching versions of core dependencies:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"React Native"}),"\n",(0,i.jsx)(n.li,{children:"React"}),"\n",(0,i.jsx)(n.li,{children:"React Test Renderer"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["React Native uses different versioning scheme from React, you can use ",(0,i.jsx)(n.a,{href:"https://react-native-community.github.io/upgrade-helper/",children:"React Native Upgrade Helper"})," to find the correct matching between React Native & React versions. In case you use Expo, you should use dependency versions recommended by them and set by ",(0,i.jsx)(n.code,{children:"expo upgrade"})," command."]}),"\n",(0,i.jsxs)(n.p,{children:["React Test Renderer usually has same major & minor version as React, as they are closely related and React Test Renderer is part of ",(0,i.jsx)(n.a,{href:"https://github.com/facebook/react",children:"React monorepo"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Related issues: ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/issues/1061",children:"#1061"}),", ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/issues/938",children:"#938"}),", ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/issues/920",children:"#920"})]}),"\n",(0,i.jsx)(n.p,{children:"Errors that might indicate that you are facing this issue:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"TypeError: Cannot read property 'current' of undefined"})," when calling ",(0,i.jsx)(n.code,{children:"render()"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"TypeError: Cannot read property 'isBatchingLegacy' of undefined"})," when calling ",(0,i.jsx)(n.code,{children:"render()"})]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"example-repository",children:"Example repository"}),"\n",(0,i.jsxs)(n.p,{children:["We maintain an ",(0,i.jsx)(n.a,{href:"https://github.com/callstack/react-native-testing-library/tree/main/examples/basic",children:"example repository"})," that showcases a modern React Native Testing Library setup with TypeScript, etc."]}),"\n",(0,i.jsx)(n.p,{children:"In case something does not work in your setup you can refer to this repository for recommended configuration."}),"\n",(0,i.jsx)(n.h2,{id:"undefined-component-error",children:"Undefined component error"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"Warning: React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: undefined."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"This frequently happens when you mock a complex module incorrectly, e.g.:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"jest.mock('@react-navigation/native', () => {\n  return {\n    useNavigation: jest.fn(),\n  };\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The above mock will mock ",(0,i.jsx)(n.code,{children:"useNavigation"})," hook as intended, but at the same time all other exports from ",(0,i.jsx)(n.code,{children:"@react-navigation/native"})," package are now ",(0,i.jsx)(n.code,{children:"undefined"}),". If you want to use ",(0,i.jsx)(n.code,{children:"NavigationContainer"})," component from the same package it will be ",(0,i.jsx)(n.code,{children:"undefined"})," and result in the error above."]}),"\n",(0,i.jsxs)(n.p,{children:["In order to mock only a part of given package you should re-export all other exports using ",(0,i.jsx)(n.code,{children:"jest.requireActual"})," helper:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"jest.mock('@react-navigation/native', () => {\n  return {\n    ...jest.requireActual('@react-navigation/native'),\n    useNavigation: jest.fn(),\n  };\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["That way the mock will re-export all of the ",(0,i.jsx)(n.code,{children:"@react-navigation/native"})," members and overwrite only the ",(0,i.jsx)(n.code,{children:"useNavigation"})," hook."]}),"\n",(0,i.jsxs)(n.p,{children:["Alternatively, you can use ",(0,i.jsx)(n.code,{children:"jest.spyOn"})," to mock package exports selectively."]}),"\n",(0,i.jsx)(n.h3,{id:"mocking-react-native",children:"Mocking React Native"}),"\n",(0,i.jsxs)(n.p,{children:["In case of mocking ",(0,i.jsx)(n.code,{children:"react-native"})," package you should not mock the whole package at once, as this approach has issues with ",(0,i.jsx)(n.code,{children:"jest.requireActual"})," call. In this case it is recommended to mock particular library paths inside the package, e.g.:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ts",children:"jest.mock('react-native/Libraries/EventEmitter/NativeEventEmitter');\n"})}),"\n",(0,i.jsx)(n.h2,{id:"act-warnings",children:"Act warnings"}),"\n",(0,i.jsxs)(n.p,{children:["When writing tests you may encounter warnings connected with ",(0,i.jsx)(n.code,{children:"act()"})," function. There are two kinds of these warnings:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["sync ",(0,i.jsx)(n.code,{children:"act()"})," warning - ",(0,i.jsx)(n.code,{children:"Warning: An update to Component inside a test was not wrapped in act(...)"})]}),"\n",(0,i.jsxs)(n.li,{children:["async ",(0,i.jsx)(n.code,{children:"act()"})," warning - ",(0,i.jsx)(n.code,{children:"Warning: You called act(async () => ...) without await"})]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["You can read more about ",(0,i.jsx)(n.code,{children:"act()"})," function in our ",(0,i.jsxs)(n.a,{href:"https://callstack.github.io/react-native-testing-library/docs/understanding-act",children:["understanding ",(0,i.jsx)(n.code,{children:"act"})," function guide"]}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["Normally, you should not encounter sync ",(0,i.jsx)(n.code,{children:"act()"})," warnings, but if that happens this probably indicate an issue with your test and should be investigated."]}),"\n",(0,i.jsxs)(n.p,{children:["In case of async ",(0,i.jsx)(n.code,{children:"act()"})," function this might happen more or less randomly, especially if your components contain async logic. So far this warning does not seem to affect test correctness."]})]})}function h(e={}){const{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(u,{...e})}):u(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>o,a:()=>s});var i=t(7294);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}}}]);